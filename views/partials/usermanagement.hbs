<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>{{title}}</title>
    <link rel="stylesheet" href="/assets/main.css" />
    <script src="/assets/lib/jquery-2.1.4.min.js"></script>
    <script src="/assets/lib/bootstrap.min.js"></script>
    <script src="/assets/main.js"></script>
    <script src="/assets/application.js"></script>
</head>
<body>
    <button type="button" class="btn btn-info btn-lg" style="margin-bottom: 10px;" data-toggle="modal" data-target="#createUserModal">Create User</button>
   
    <div id="createUserModal" class="modal fade" role="dialog" tabindex="">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header">
                    <button type="button" class="close" data-dismiss="modal">&times;</button>
                    <h4 class="modal-title">Add New User</h4>
                </div>
                <div class="modal-body">
                    <form id="signup-form" method="POST" class="form-horizontal">
                        <input type="hidden" name="_csrf" value="{{_csrf}}" />
                        <div class="form-group">
                            <label for="email" class="col-sm-3 control-label">Email</label>
                            <div class="col-sm-7">
                                <input type="email" name="email" id="email" placeholder="Email" autofocus="autofocus" class="form-control" />
                            </div>
                        </div>
                        <div class="form-group">
                            <label for="password" class="col-sm-3 control-label">Password</label>
                            <div class="col-sm-7">
                                <input type="password" name="password" id="password" placeholder="Password" class="form-control" />
                            </div>
                        </div>
                        <div class="form-group">
                            <label for="confirmPassword" class="col-sm-3 control-label">Confirm Password</label>
                            <div class="col-sm-7">
                                <input type="password" name="confirmPassword" id="confirmPassword" placeholder="Confirm Password" class="form-control" />
                            </div>
                        </div>

                        <div class="form-group">
                            <label for="confirmPassword" class="col-sm-3 control-label">User Role</label>
                            <div class="col-sm-7">
                                <select>
                                    <option value="Blocked" id="userRole">Blocked</option>
                                    <option value="User" id="userRole">User</option>
                                    <option value="Admin" id="userRole">Admin</option>
                                    <option value="Site Admin" id="userRole">Site Admin</option>
                                </select>
                            </div>
                        </div>
                    </form>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-default" data-dismiss="modal">Cancel</button>
                    <button type="button" class="btn btn-default" data-dismiss="modal">Create User</button>
                </div>
            </div>
        </div>
    </div>

    <div id="deleteUserModal" class="modal fade" role="dialog" tabindex="">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header">
                    <button type="button" class="close" data-dismiss="modal">&times;</button>
                    <h4 class="modal-title" name="usernameheader"></h4>
                </div>
                <div class="modal-body">
                    <p name="usernameparagraph"></p>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-default" data-dismiss="modal">Cancel</button>
                    <button type="button" class="btn btn-default" data-dismiss="modal">Delete User</button>
                </div>
            </div>
        </div>
    </div>
    
     <table class="table-striped table-condensed table-hover table table-bordered">
        <tr>
            <th>Full Name</th>
            <th>Display Name</th>
            <th>M Number</th>
            <th>E-Mail</th>
            <th>User Role</th>
            <th>Contact User</th>
            <th>Delete User</th>
        </tr>
        {{#each users}}
        <tr>
            <td>{{this.profile.fullName}}</td>
            <td>{{this.profile.displayName}}</td>
            <td>{{this.mNumber}}</td>
            <td>{{this.email}}</td>
            <td><select>
                    <option>Blocked</option>
                    <option>User</option>
                    <option>Admin</option>
                    <option>Site Admin</option>
                </select></td>
            <td><a href="/">Contact User</a></td>
            <td><a data-toggle="modal" data-target="#deleteUserModal" data-user-id="{{this._id}}" data-user-fullname="{{this.profile.fullName}}">Delete User</a></td>
        </tr>
        {{/each}}
    </table>
</body>
</html>

<script type="text/javascript">
    $('#deleteUserModal').on('show.bs.modal', function (e) {

        //get data-id attribute of the clicked element
        var userId = $(e.relatedTarget).data('user-id');
        var userName = $(e.relatedTarget).data('user-fullname');
        console.log(userName);
        //populate the textbox
        $(e.currentTarget).find('input[name="userId"]').val(userId);
        $(e.currentTarget).find('h4[name="usernameheader"]').text("Delete User: " + userName);
        var message = "You are about to delete the profile for " + userName + ". This is permanent. Do you want to continue?";
        $(e.currentTarget).find('p[name="usernameparagraph"]').text(message);
    });
</script>